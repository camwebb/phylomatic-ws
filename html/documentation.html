<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
	<meta content="application/xhtml+xml; charset=utf-8" http-equiv="content-type"/>
	<link rel="stylesheet" href="../css/default.css" type="text/css" />
	<title>Documentation</title>
  </head>
  <body>
	<h1>Phylomatic Documentation</h1>
	<h2>Version 3</h2>
	<h3>Source</h3>
	<ul>
	  <li>
		<a href="https://github.com/camwebb/phylomatic-ws">at github</a>
	  </li>
	</ul>
    <h3>Sending data with <code>curl</code></h3>
    <p>
      <code>curl</code> is a handy command line tool for interacting
      with websites.  You can send the data from a web-form back to
      the server from <code>curl</code>, if you know the
      parameters. The easiest way to use this to send data to
      phylomatic is first to create a text file (e.g.,
      <code>phylomatic.dat</code>) with the parameter data:
    </p>
    <pre>
      storedtree=R20120829&amp;informat=newick&amp;method=phylomatic&amp;
      taxaformat=slashpath&amp;outformat=newick&amp;
      taxa=acanthaceae%2Fbravaisia%2Fbravaisia_sp1%0D
      acanthaceae%2Fsuessenguthia%2Fsuessenguthia_sp1%0D
      ...
      %0D
    </pre>
    <p>
      Note that there should be no line-breaks in your input file. The
      whole thing should be one long string of text. The
      <code>%2F</code> and <code>%0D</code> symbols are URL-encoded
      slashes and newline characters, respectively.  Then just send
      the data to te server with:
    </p>
    <pre>
      $ curl -d @phylomatic.dat http://phylodiversity.net/phylomatic/pmws > output.new
    </pre>
    <p>
      (The <code>&gt; output.new</code> redirects the output to a
      file)
    </p>
    <h3>Too many taxa for this online version of phylomatic?</h3>
    <p>If you have more than about 5,000 taxa, a job on this server
    will take too long and the gateway will timeout. A limit of 5,000
    taxa has now been placed on a taxa file. You have two
    alternatives:</p>
    <ol>
      <li>Use the desktop version of <tt>phylomatic</tt>, available
      with <tt>phylocom</tt>, or</li>
      <li>Use this (<tt>gawk</tt>-powered) version of
      <tt>phylomatic</tt> on your own computer:
      <ol>
        <li>Aquire the files from <a
        href="https://github.com/camwebb/phylomatic-ws">github</a>.</li>
        <li>Make sure the first line of the <tt>pmws</tt> file points
        to your <tt>gawk</tt> (version >= 4.0) executable.</li>
        <li>Run with (for example):</li>
      </ol>
      </li>
    </ol>
    <pre>
      $ echo "informat=newick&amp;storedtree=R20120829&amp;method=phylomatic&amp;taxauri=http://foo.com/bar.new&amp;outformat=newick&amp;local=1" \
        | path/to/pmws > out.new
    </pre>
    <p>(Note the <tt>local=1</tt> switch!)</p>
 	<h3>Acknowledgements</h3>
	<ul>
	  <li>
		Thanks to the <a href="http://phylotastic.org">Phylotastic</a> working group at NESCent, and the sponsors of the meeting.
	  </li>
	</ul>

	<h2>Previous phylomatic versions</h2>
	<!-- <p>(Beware bad hand-coded HTML!)</p> -->
	<ul>
	  <li><b>PHYLOMATIC v2 IS NOW OFFLINE</b><a name="pm2hacked">
	  </a>(2013-01-10) The phylomatic v2 web-app was just hacked. I
	  could restore it, but in its current form, I would have to do
	  some significant rewriting to make it fully secure.  Since
	  developing the (more secure, I hope) <a
	  href="http://phylodiversity.net/phylomatic/">phylomatic version
	  3 web service</a>, I am not inclined to spend time on v2, and so
	  must depreciate it.  I am aware that some users have built
	  version 2 into scripts, and apologize in advance for any work
	  required to re-write script to utilize version 3; please blame
	  the hacker rather than me. If converting to version 3 will
	  present a significant problem for you, <em>please</em> do
	  contact me via email.<br/><br/>For reference only: version 2 <a
	  href="pm2_form.html">form</a>, <a
	  href="pm2_back.html">background</a> and description of <a
	  href="pm2_api.html">API</a>.
	  </li>
	  <li>
		Version 1 <a
		href="pm1.html">background</a>
	  </li>
	</ul>
  </body>
</html>
